# Phase 5 — Layer/α Sweep

## 🎯 目的

- α sweep（負→正）で各層の影響を計測
- Transformerベースのsentiment/politeness評価で評価

## 📦 生成物

- `gpt2_sweep_token_based.pkl`
- 図（layer × α）
- `docs/phase5_report.md`

## 🚀 実行コマンド例

```bash
python -m src.models.activation_patching_sweep \
  --model gpt2 \
  --vectors_file results/baseline/emotion_vectors/gpt2_vectors_token_based.pkl \
  --prompts_file data/neutral_prompts.json \
  --output results/baseline/patching/gpt2_sweep_token_based.pkl \
  --layers 3 5 7 9 11 \
  --alpha -2 -1 -0.5 0 0.5 1 2
```

## 📄 レポート項目

### 1. Sweep実験設定

#### 実験パラメータ
- モデル: [gpt2 / pythia-160m / gpt-neo-125M]
- 層: [3, 5, 7, 9, 11]
- α値: [-2, -1, -0.5, 0, 0.5, 1, 2]
- プロンプト数: [数]
- max_new_tokens: [数]

#### 評価指標
- Sentiment (CardiffNLP)
- Politeness (Stanford Politeness)
- Emotions (GoEmotions)

### 2. 層×αの効果マトリックス

#### Sentiment変化（Δsentiment）

| 層 | α=-2 | α=-1 | α=-0.5 | α=0 | α=0.5 | α=1 | α=2 |
|----|------|------|--------|-----|-------|-----|-----|
| 3  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 5  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 7  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 9  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 11 | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |

#### Politeness変化（Δpoliteness）

| 層 | α=-2 | α=-1 | α=-0.5 | α=0 | α=0.5 | α=1 | α=2 |
|----|------|------|--------|-----|-------|-----|-----|
| 3  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 5  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 7  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 9  | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |
| 11 | [値] | [値] | [値]   | [値] | [値]  | [値] | [値] |

### 3. 感情別の効果

#### Gratitude

| 層 | 最適α | 最大効果 | メトリクス |
|----|------|---------|----------|
| 3  | [値] | [値]    | [メトリクス名] |
| 5  | [値] | [値]    | [メトリクス名] |
| 7  | [値] | [値]    | [メトリクス名] |
| 9  | [値] | [値]    | [メトリクス名] |
| 11 | [値] | [値]    | [メトリクス名] |

#### Anger

| 層 | 最適α | 最大効果 | メトリクス |
|----|------|---------|----------|
| 3  | [値] | [値]    | [メトリクス名] |
| 5  | [値] | [値]    | [メトリクス名] |
| 7  | [値] | [値]    | [メトリクス名] |
| 9  | [値] | [値]    | [メトリクス名] |
| 11 | [値] | [値]    | [メトリクス名] |

#### Apology

| 層 | 最適α | 最大効果 | メトリクス |
|----|------|---------|----------|
| 3  | [値] | [値]    | [メトリクス名] |
| 5  | [値] | [値]    | [メトリクス名] |
| 7  | [値] | [値]    | [メトリクス名] |
| 9  | [値] | [値]    | [メトリクス名] |
| 11 | [値] | [値]    | [メトリクス名] |

### 4. 可視化結果

#### ヒートマップ
- Layer × α のヒートマップ: [ファイルパス]
- 感情別ヒートマップ: [ファイルパス]

#### バイオリンプロット
- 分布の比較: [ファイルパス]

### 5. 考察

#### 層依存性
- [どの層が最も効果的か]

#### α値の最適範囲
- [最適なα値の範囲]

#### 感情別の特徴
- [感情ごとの特徴的なパターン]

#### Transformerベース評価の有効性
- [ヒューリスティック指標との比較]

## 📝 備考

[その他の注意事項やメモ]

