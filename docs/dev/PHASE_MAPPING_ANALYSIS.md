# Phase ãƒãƒƒãƒ”ãƒ³ã‚°åˆ†æãƒ¬ãƒãƒ¼ãƒˆ

## ä»•æ§˜æ›¸ã®Phaseå®šç¾©ï¼ˆmasterplan.mdå„ªå…ˆï¼‰

### Phase 0: ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»ç’°å¢ƒæ•´å‚™
- ç›®çš„: å®Ÿè¡ŒåŸºç›¤ã®æ•´å‚™
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: ãªã—ï¼ˆç’°å¢ƒæ§‹ç¯‰ã®ã¿ï¼‰

### Phase 1: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ & è©•ä¾¡è¨­è¨ˆ
- ç›®çš„: æ„Ÿæƒ…ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨è©•ä¾¡æŒ‡æ¨™ã®ç¢ºå®š
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `src/data/` é…ä¸‹ï¼ˆæœ¬åˆ†æå¯¾è±¡å¤–ï¼‰

### Phase 2: æ´»æ€§æŠ½å‡º
- ç›®çš„: å„ãƒ¢ãƒ‡ãƒ«ã® hidden states / residual ã‚’å–å¾—
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `run_phase2_activations.py` âœ“ **æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°æ¸ˆã¿**

### Phase 3: æ„Ÿæƒ…ãƒ™ã‚¯ãƒˆãƒ« & ã‚µãƒ–ã‚¹ãƒšãƒ¼ã‚¹æ§‹ç¯‰
- ç›®çš„: å„ãƒ¢ãƒ‡ãƒ«ãƒ»å„å±¤ã§æ„Ÿæƒ…æ–¹å‘ã¨æ„Ÿæƒ…ã‚µãƒ–ã‚¹ãƒšãƒ¼ã‚¹ã‚’å®šç¾©
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `run_phase3_vectors.py` âœ“ **æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°æ¸ˆã¿**

### Phase 4: ãƒ¢ãƒ‡ãƒ«é–“ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
- ç›®çš„: ã‚µãƒ–ã‚¹ãƒšãƒ¼ã‚¹ã®å…±é€šæ€§ã‚’æ¸¬ã‚Šã€ç·šå½¢å†™åƒã§åº§æ¨™ç³»ã®é•ã„ã‚’å–ã‚Šé™¤ã
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `run_phase4_alignment.py` âœ“ **æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°æ¸ˆã¿**

### Phase 5: æ®‹å·®ãƒ™ã‚¯ãƒˆãƒ«ã® causal patching
- ç›®çš„: multi-token patching ã§æ„Ÿæƒ…ãƒ™ã‚¯ãƒˆãƒ«/ã‚µãƒ–ã‚¹ãƒšãƒ¼ã‚¹ã®å› æœåŠ¹æœã‚’æ¤œè¨¼
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `run_phase5_residual_patching.py` âœ“ **æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°æ¸ˆã¿**

### Phase 6: Head ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚° & ãƒ‘ãƒƒãƒãƒ³ã‚°
- ç›®çš„: ã©ã® head ãŒæ„Ÿæƒ…æƒ…å ±ã«æ•æ„Ÿã‹ã€head ãƒ‘ãƒƒãƒãƒ³ã‚°/ã‚¢ãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å› æœåŠ¹æœã‚’æ¸¬å®š
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ:
  - `run_phase6_head_screening.py` âœ“ **æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°æ¸ˆã¿**ï¼ˆå…¨headã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼‰
  - `run_phase6_head_patching.py` âš ï¸ **å®Ÿè£…ã¯ablationï¼ˆã‚¼ãƒ­åŒ–ï¼‰ã®ã¿**ï¼ˆpattern_v/v_onlyæœªå®Ÿè£…ï¼‰

### Phase 7: çµ±è¨ˆçš„å³å¯†æ€§
- ç›®çš„: Phase 5-6 ã®çµæœã¨ Phase 4 ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã«ã¤ã„ã¦çµ±è¨ˆçš„ã«è©•ä¾¡
- ã‚„ã‚‹ã“ã¨: Effect size, p-value, power analysis, k-selection
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: `run_phase7_statistics.py` âœ“ **æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°æ¸ˆã¿**

### Phase 8: å›è·¯ãƒ¬ãƒ™ãƒ«è§£å‰–ï¼ˆå°†æ¥ï¼‰
- ç›®çš„: è¤‡æ•° head + MLP ã‚’å«ã‚€å°ã•ãªæ„Ÿæƒ…å›è·¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ç‰¹å®š
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: æœªå®Ÿè£…ï¼ˆå°†æ¥ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼‰

---

## ç™ºè¦‹äº‹é …ã¨ä¿®æ­£ãŒå¿…è¦ãªç‚¹

### 1. Phase 6 ã® head patching ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã¤ã„ã¦

**ç¾çŠ¶:**
- `run_phase6_head_patching.py` ã¯å®Ÿéš›ã«ã¯ **head ablationï¼ˆã‚¼ãƒ­åŒ–ï¼‰** ã®ã¿ã‚’å®Ÿè£…
- Codex Instruction Document ã§è¨€åŠã•ã‚Œã¦ã„ã‚‹ã€Œpattern_v / v_only ã§ã® causal patchingã€ã¯æœªå®Ÿè£…

**Codex Instruction Document ã® Phase 7 å®šç¾©ã¨ã®ä¸ä¸€è‡´:**
- Codex: "Phase 7: Head-level Patchingï¼ˆpattern_v / v_onlyï¼‰"
- masterplan.md: "Phase 7: çµ±è¨ˆçš„å³å¯†æ€§"

**æ¨å¥¨:**
- masterplan.md ã‚’å„ªå…ˆã—ã€`run_phase6_head_patching.py` ã¯ Phase 6 ã®ä¸€éƒ¨ã¨ã—ã¦æ‰±ã†
- pattern_v/v_only ã®å®Ÿè£…ãŒå¿…è¦ãªå ´åˆã¯ã€Phase 6 ã®æ‹¡å¼µã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã‹ã€åˆ¥é€” Phase 6.5 ã¨ã—ã¦æ‰±ã†

### 2. Phase 7 ã®åç§°ã«ã¤ã„ã¦

**ç¾çŠ¶:**
- `run_phase7_statistics.py` ã¯ masterplan.md ã® Phase 7ã€Œçµ±è¨ˆçš„å³å¯†æ€§ã€ã«è©²å½“
- Codex Instruction Document ã§ã¯ã€ŒPhase 7.5: çµ±è¨ˆè§£æã€ã¨è¨˜è¼‰

**æ¨å¥¨:**
- masterplan.md ã«åˆã‚ã›ã¦ Phase 7 ã¨ã—ã¦çµ±ä¸€
- ã‚³ãƒ¼ãƒ‰å†…ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚„docstringã‚‚ Phase 7 ã«çµ±ä¸€

### 3. è£œåŠ©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

- `evaluation.py`: å…¨Phaseå…±é€šã®è©•ä¾¡å™¨ï¼ˆPhase 1 ã§å®šç¾©ã•ã‚ŒãŸè©•ä¾¡æŒ‡æ¨™ï¼‰
- `sentiment_eval.py`: è©•ä¾¡å™¨ã®å®Ÿè£…è©³ç´°
- `statistics/`: Phase 7 ã®çµ±è¨ˆè¨ˆç®—ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¾¤

---

## ä¿®æ­£å®Œäº†ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«

### 1. `run_phase6_head_patching.py` âœ…
- **ä¿®æ­£å†…å®¹**: 
  - docstring ã‚’ã€ŒPhase 6ï¼ˆHead Ablationï¼‰ã€ã«æ›´æ–°ã—ã€masterplan.md ã¸ã®å‚ç…§ã‚’è¿½åŠ 
  - ã™ã¹ã¦ã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã€ŒPhase 6-bã€ã‹ã‚‰ã€ŒPhase 6ã€ã«çµ±ä¸€
  - argparse description ã‚’ã€ŒPhase 6: Head Ablationã€ã«æ›´æ–°

### 2. `run_phase6_head_screening.py` âœ…
- **ä¿®æ­£å†…å®¹**:
  - docstring ã‚’ã€ŒPhase 6ï¼ˆHead Screeningï¼‰ã€ã«æ›´æ–°ã—ã€masterplan.md ã¸ã®å‚ç…§ã‚’è¿½åŠ 
  - ã™ã¹ã¦ã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã€ŒPhase 6-aã€ã‹ã‚‰ã€ŒPhase 6ã€ã«çµ±ä¸€
  - argparse description ã‚’ã€ŒPhase 6: Head Screeningã€ã«æ›´æ–°
  - `get_default_device_str()` ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’è¿½åŠ ï¼ˆãƒ‡ãƒã‚¤ã‚¹ç®¡ç†ã®çµ±ä¸€ï¼‰

### 3. `run_phase7_statistics.py` âœ…
- **ä¿®æ­£å†…å®¹**:
  - argparse description ã‚’ã€ŒPhase 7.5ã€ã‹ã‚‰ã€ŒPhase 7: çµ±è¨ˆçš„å³å¯†æ€§ï¼ˆåŠ¹æœé‡ãƒ»æœ‰æ„æ€§ãƒ»ké¸æŠï¼‰ã€ã«æ›´æ–°
  - ã‚³ãƒ¡ãƒ³ãƒˆå†…ã®ã€ŒPhase 7ã€è¡¨è¨˜ã¯æ—¢ã«æ­£ã—ãçµ±ä¸€ã•ã‚Œã¦ã„ãŸ

### 4. `statistics/__init__.py` âœ…
- **ä¿®æ­£å†…å®¹**:
  - docstring ã‚’ã€ŒPhase 7.5ã€ã‹ã‚‰ã€ŒPhase 7 çµ±è¨ˆçš„å³å¯†æ€§ã®ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€ã«æ›´æ–°
  - masterplan.md ã¸ã®å‚ç…§ã‚’è¿½åŠ 

### 5. `statistics/power_analysis.py` âœ…
- **ä¿®æ­£å†…å®¹**:
  - docstring ã‚’ã€ŒPhase 7.5ã€ã‹ã‚‰ã€ŒPhase 7 æ¤œå‡ºåŠ›åˆ†æãƒ˜ãƒ«ãƒ‘ãƒ¼ã€ã«æ›´æ–°
  - masterplan.md ã¸ã®å‚ç…§ã‚’è¿½åŠ 

---

## çµè«–

### âœ… ä¿®æ­£å®Œäº†
1. **Phase 2-5**: ã™ã¹ã¦æ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°æ¸ˆã¿ï¼ˆä¿®æ­£ä¸è¦ï¼‰
2. **Phase 6**: 2ã¤ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚³ãƒ¡ãƒ³ãƒˆã¨ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã€ŒPhase 6ã€ã«çµ±ä¸€å®Œäº†
3. **Phase 7**: ã™ã¹ã¦ã®ã‚³ãƒ¡ãƒ³ãƒˆã¨docstringã‚’ã€ŒPhase 7ã€ã«çµ±ä¸€å®Œäº†
4. **Phase 8**: æœªå®Ÿè£…ï¼ˆå°†æ¥ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼‰

### ğŸ“ ä»Šå¾Œã®æ¤œè¨äº‹é …
- **pattern_v/v_only ã®å®Ÿè£…**: Codex Instruction Document ã§è¨€åŠã•ã‚Œã¦ã„ã‚‹ãŒã€ç¾çŠ¶æœªå®Ÿè£…
  - å¿…è¦ã«å¿œã˜ã¦ Phase 6 ã®æ‹¡å¼µã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã‹ã€åˆ¥é€” Phase 6.5 ã¨ã—ã¦æ‰±ã†
  - å®Ÿè£…ã™ã‚‹å ´åˆã¯ã€`run_phase6_head_patching.py` ã‚’æ‹¡å¼µã™ã‚‹ã‹ã€æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã™ã‚‹

