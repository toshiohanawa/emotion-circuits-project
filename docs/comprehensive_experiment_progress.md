# åŒ…æ‹¬çš„å¤šãƒ¢ãƒ‡ãƒ«å®Ÿé¨“ã®é€²æ—çŠ¶æ³

æœ€çµ‚æ›´æ–°: 2025-01-XXï¼ˆPhase5å®Œäº†ç¢ºèªï¼‰

## å®Ÿé¨“æ¦‚è¦

- **ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«**: `baseline`ï¼ˆå„æ„Ÿæƒ…225ã‚µãƒ³ãƒ—ãƒ«ã€åˆè¨ˆ900ã‚µãƒ³ãƒ—ãƒ«ï¼‰
- **å¯¾è±¡ãƒ¢ãƒ‡ãƒ«**: 
  - å°å‹ãƒ¢ãƒ‡ãƒ«3ã¤: `gpt2_small`, `pythia-160m`, `gpt-neo-125m`
  - ä¸­è¦æ¨¡ãƒ¢ãƒ‡ãƒ«3ã¤: `llama3_8b`, `gemma3_12b`, `qwen3_8b`
- **å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `scripts/run_comprehensive_experiment.sh` ãŠã‚ˆã³å„Phaseç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

## Phaseåˆ¥é€²æ—çŠ¶æ³

### âœ… Phase 1: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæ§‹ç¯‰

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Œäº†
- **å®Ÿè¡Œæ—¥æ™‚**: 2025-01-XX
- **å‡ºåŠ›**: `data/emotion_dataset.jsonl`ï¼ˆ900è¡Œï¼‰
- **è©³ç´°**:
  - gratitude: 225ã‚µãƒ³ãƒ—ãƒ«
  - anger: 225ã‚µãƒ³ãƒ—ãƒ«
  - apology: 225ã‚µãƒ³ãƒ—ãƒ«
  - neutral: 225ã‚µãƒ³ãƒ—ãƒ«

### âœ… Phase 2: æ´»æ€§æŠ½å‡º

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Œäº†ï¼ˆ5ãƒ¢ãƒ‡ãƒ«ï¼‰
- **å®Ÿè¡Œæ—¥æ™‚**: 2025-01-XX
- **å®Œäº†ã—ãŸãƒ¢ãƒ‡ãƒ«**:
  - âœ… `gpt2_small` (12å±¤)
  - âœ… `pythia-160m` (12å±¤)
  - âœ… `gpt-neo-125m` (12å±¤)
  - âœ… `llama3_8b` (32å±¤)
  - âœ… `qwen3_8b` (36å±¤)
- **ã‚¹ã‚­ãƒƒãƒ—**:
  - âš  `gemma3_12b` (48å±¤) - GPUãƒ¡ãƒ¢ãƒªä¸è¶³ã®ãŸã‚ã‚¹ã‚­ãƒƒãƒ—
- **å‡ºåŠ›**: `results/baseline/activations/<model>.pkl`

### âœ… Phase 3: æ„Ÿæƒ…ãƒ™ã‚¯ãƒˆãƒ«è¨ˆç®—

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Œäº†ï¼ˆ5ãƒ¢ãƒ‡ãƒ«ï¼‰
- **å®Ÿè¡Œæ—¥æ™‚**: 2025-01-XX
- **å®Œäº†ã—ãŸãƒ¢ãƒ‡ãƒ«**:
  - âœ… `gpt2_small`
  - âœ… `pythia-160m`
  - âœ… `gpt-neo-125m`
  - âœ… `llama3_8b`
  - âœ… `qwen3_8b`
- **å‡ºåŠ›**: 
  - `results/baseline/emotion_vectors/<model>_vectors.pkl`
  - `results/baseline/emotion_subspaces/<model>_subspaces.pkl`

### â¸ Phase 4: ãƒ¢ãƒ‡ãƒ«é–“ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ã‚¹ã‚­ãƒƒãƒ—
- **ç†ç”±**: ç•°ãªã‚‹d_modelã‚’æŒã¤ãƒ¢ãƒ‡ãƒ«é–“ï¼ˆå°å‹ãƒ¢ãƒ‡ãƒ«: 768æ¬¡å…ƒã€ä¸­è¦æ¨¡ãƒ¢ãƒ‡ãƒ«: 4096æ¬¡å…ƒï¼‰ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã¯ç¾åœ¨ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„
- **å¯¾å¿œ**: å¾Œã§å€‹åˆ¥ã«å¯¾å¿œãŒå¿…è¦ï¼ˆProcrustesåˆ†æã®å®Ÿè£…ä¿®æ­£ãŒå¿…è¦ï¼‰
- **å½±éŸ¿**: Phase7ã®kãƒ¢ãƒ¼ãƒ‰ã¯å®Ÿè¡Œã§ããªã„ï¼ˆPhase4ã®çµæœãŒå¿…è¦ï¼‰

### âœ… Phase 5: æ®‹å·®ãƒ‘ãƒƒãƒãƒ³ã‚°

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Œäº†ï¼ˆ5ãƒ¢ãƒ‡ãƒ«ï¼‰
- **å®Œäº†æ—¥æ™‚**: 2025-01-XX

#### å°å‹ãƒ¢ãƒ‡ãƒ«ï¼ˆå…¨12å±¤ï¼‰

- âœ… `gpt2_small`: å®Œäº†
  - å‡ºåŠ›: `results/baseline/patching/residual/gpt2_small_residual_sweep.pkl` (240K)
- âœ… `pythia-160m`: å®Œäº†
  - å‡ºåŠ›: `results/baseline/patching/residual/pythia-160m_residual_sweep.pkl` (244K)
- âœ… `gpt-neo-125m`: å®Œäº†
  - å‡ºåŠ›: `results/baseline/patching/residual/gpt-neo-125m_residual_sweep.pkl` (229K)

#### ä¸­è¦æ¨¡ãƒ¢ãƒ‡ãƒ«ï¼ˆå±¤åˆ†å‰²å®Ÿè¡Œï¼‰

- âœ… `llama3_8b`: å®Œäº†ï¼ˆå±¤0-31ã€å±¤åˆ†å‰²å®Ÿè¡Œï¼‰
  - å‡ºåŠ›: `results/baseline/patching/residual/llama3_8b_residual_sweep.pkl` (322K)
- âœ… `qwen3_8b`: å®Œäº†ï¼ˆå±¤0-35ã€å±¤åˆ†å‰²å®Ÿè¡Œï¼‰
  - å‡ºåŠ›: `results/baseline/patching/residual/qwen3_8b_residual_sweep.pkl` (360K)
- âš  `gemma3_12b`: ã‚¹ã‚­ãƒƒãƒ—ï¼ˆãƒ¡ãƒ¢ãƒªä¸è¶³ï¼‰

### âœ… Phase 6a: Head Screening

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Œäº†ï¼ˆå…¨5ãƒ¢ãƒ‡ãƒ«ï¼‰
- **å®Œäº†æ—¥æ™‚**: 2025-11-20 10:19ï¼ˆæœ€çµ‚æ›´æ–°ï¼‰

#### å°å‹ãƒ¢ãƒ‡ãƒ«ï¼ˆå…¨12å±¤ã€å„144ãƒ˜ãƒƒãƒ‰ï¼‰

- âœ… `gpt2_small`: å®Œäº†
  - å‡ºåŠ›: `results/baseline/screening/head_scores_gpt2_small.json` (4.7MB)
- âœ… `pythia-160m`: å®Œäº†
  - å‡ºåŠ›: `results/baseline/screening/head_scores_pythia-160m.json` (4.7MB)
- âœ… `gpt-neo-125m`: å®Œäº†
  - å‡ºåŠ›: `results/baseline/screening/head_scores_gpt-neo-125m.json` (4.7MB)

#### ä¸­è¦æ¨¡ãƒ¢ãƒ‡ãƒ«ï¼ˆå±¤åˆ†å‰²å®Ÿè¡Œï¼‰

- âœ… `llama3_8b`: å®Œäº†ï¼ˆå±¤0-31ã€å±¤åˆ†å‰²å®Ÿè¡Œï¼‰
  - å‡ºåŠ›: `results/baseline/screening/head_scores_llama3_8b.json` (3.7MB)
- ğŸ”„ `qwen3_8b`: å®Ÿè¡Œä¸­ï¼ˆå±¤0-17å®Œäº†ã€å±¤18-35å®Ÿè¡Œä¸­ï¼‰
  - âœ… å±¤0-17: å®Œäº†ï¼ˆ10:19å®Œäº†ï¼‰
  - ğŸ”„ å±¤18-35: å®Ÿè¡Œä¸­ï¼ˆ09:40é–‹å§‹ã€ç´„13æ™‚é–“çµŒéã€ãƒ—ãƒ­ã‚»ã‚¹ID: 180242ï¼‰
  - å‡ºåŠ›: `results/baseline/screening/head_scores_qwen3_8b.json` (18.0MBã€ç¾åœ¨ã¯å±¤0-17ã®ã¿)
- âš  `gemma3_12b`: ã‚¹ã‚­ãƒƒãƒ—ï¼ˆãƒ¡ãƒ¢ãƒªä¸è¶³ï¼‰

### ğŸ”„ Phase 6b: Head Patching

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æº–å‚™å®Œäº†ï¼ˆPhase6aå®Œäº†ã«ã‚ˆã‚Šå®Ÿè¡Œå¯èƒ½ï¼‰
- **ä¾å­˜**: Phase6aå®Œäº†æ¸ˆã¿ âœ…
- **å®Ÿè¡Œäºˆå®š**: æ¬¡ã«å®Ÿè¡Œ

### â³ Phase 7: çµ±è¨ˆè§£æ

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æœªå®Ÿè¡Œ
- **ä¾å­˜**: Phase5, Phase6bå®Œäº†å¾Œ
- **å®Ÿè¡Œäºˆå®š**: Phase5, Phase6bå®Œäº†å¾Œ
- **ãƒ¢ãƒ¼ãƒ‰**: effect, power, kï¼ˆkãƒ¢ãƒ¼ãƒ‰ã¯Phase4ãŒå¿…è¦ãªãŸã‚å®Ÿè¡Œä¸å¯ï¼‰

### â³ æ¤œè¨¼: å…¨Phaseã®çµæœæ¤œè¨¼

- **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æœªå®Ÿè¡Œ
- **ä¾å­˜**: Phase7å®Œäº†å¾Œ
- **å®Ÿè¡Œäºˆå®š**: Phase7å®Œäº†å¾Œ

## å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒä½œæˆæ¸ˆã¿ã§ã™ï¼š

- `scripts/run_comprehensive_experiment.sh`: å…¨Phaseã‚’é †æ¬¡å®Ÿè¡Œ
- `scripts/run_phase2_all_models.sh`: Phase2ã‚’å…¨ãƒ¢ãƒ‡ãƒ«ã§å®Ÿè¡Œ
- `scripts/run_phase3_all_models.sh`: Phase3ã‚’å…¨ãƒ¢ãƒ‡ãƒ«ã§å®Ÿè¡Œ
- `scripts/run_phase4_all_combinations.sh`: Phase4ã‚’å…¨çµ„ã¿åˆã‚ã›ã§å®Ÿè¡Œï¼ˆç¾åœ¨ã‚¹ã‚­ãƒƒãƒ—ï¼‰
- `scripts/run_phase5_all_models.sh`: Phase5ã‚’å…¨ãƒ¢ãƒ‡ãƒ«ã§å®Ÿè¡Œï¼ˆå±¤åˆ†å‰²å¯¾å¿œï¼‰
- `scripts/run_phase6a_all_models.sh`: Phase6aã‚’å…¨ãƒ¢ãƒ‡ãƒ«ã§å®Ÿè¡Œï¼ˆå±¤åˆ†å‰²å¯¾å¿œï¼‰
- `scripts/run_phase6b_all_models.sh`: Phase6bã‚’å…¨ãƒ¢ãƒ‡ãƒ«ã§å®Ÿè¡Œ
- `scripts/run_phase7_all.sh`: Phase7ã‚’å…¨ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ

## æ—¢çŸ¥ã®å•é¡Œã¨å¯¾å¿œ

### 1. gemma3_12bã®ãƒ¡ãƒ¢ãƒªä¸è¶³

- **å•é¡Œ**: 12Bãƒ¢ãƒ‡ãƒ«ã¯GPUãƒ¡ãƒ¢ãƒªï¼ˆ23.54 GiBï¼‰ãŒä¸è¶³ã™ã‚‹
- **è©¦è¡Œ**: ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’1ã«ã—ã¦ã‚‚å®Ÿè¡Œä¸å¯
- **å¯¾å¿œ**: CPUã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã‚„8bité‡å­åŒ–ãªã©ã®å¯¾å¿œãŒå¿…è¦
- **ç¾çŠ¶**: Phase2, Phase5ã§ã‚¹ã‚­ãƒƒãƒ—

### 2. Phase4ã®ç•°ãªã‚‹d_modelé–“ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ

- **å•é¡Œ**: å°å‹ãƒ¢ãƒ‡ãƒ«ï¼ˆd_model=768ï¼‰ã¨ä¸­è¦æ¨¡ãƒ¢ãƒ‡ãƒ«ï¼ˆd_model=4096ï¼‰é–“ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„
- **åŸå› **: Procrustesåˆ†æã®å®Ÿè£…ãŒåŒã˜æ¬¡å…ƒç©ºé–“ã‚’å‰æã¨ã—ã¦ã„ã‚‹
- **å¯¾å¿œ**: `_procrustes_torch`ã¨`_subspace_overlap_torch`ã®å®Ÿè£…ä¿®æ­£ãŒå¿…è¦
- **ç¾çŠ¶**: Phase4ã‚’ã‚¹ã‚­ãƒƒãƒ—

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. Phase5ã®å®Œäº†ã‚’å¾…ã¤ï¼ˆæ¨å®š: æ•°æ™‚é–“ã€œ1æ—¥ï¼‰
2. Phase6aï¼ˆHead Screeningï¼‰ã‚’å®Ÿè¡Œ
3. Phase6bï¼ˆHead Patchingï¼‰ã‚’å®Ÿè¡Œ
4. Phase7ï¼ˆçµ±è¨ˆè§£æï¼‰ã‚’å®Ÿè¡Œï¼ˆeffect/powerãƒ¢ãƒ¼ãƒ‰ï¼‰
5. çµæœæ¤œè¨¼ã‚’å®Ÿè¡Œ

## å®Ÿè¡Œæ™‚é–“ã®è¦‹ç©ã‚‚ã‚Š

- Phase 1: <1åˆ† âœ…
- Phase 2: ç´„30åˆ† âœ…
- Phase 3: ç´„5åˆ† âœ…
- Phase 4: ã‚¹ã‚­ãƒƒãƒ— â¸
- Phase 5: ç´„30-60æ™‚é–“ï¼ˆå…¨ãƒ¢ãƒ‡ãƒ«ã€å±¤åˆ†å‰²å®Ÿè¡Œï¼‰ ğŸ”„
- Phase 6a: ç´„40-80æ™‚é–“ï¼ˆå…¨ãƒ¢ãƒ‡ãƒ«ã€å±¤åˆ†å‰²å®Ÿè¡Œï¼‰ â³
- Phase 6b: ç´„10-20æ™‚é–“ï¼ˆå…¨ãƒ¢ãƒ‡ãƒ«ï¼‰ â³
- Phase 7: ç´„2-3æ™‚é–“ â³

**åˆè¨ˆæ¨å®š**: ç´„90-175æ™‚é–“ï¼ˆç´„4-7æ—¥ã€ä¸¦åˆ—å®Ÿè¡Œã‚’è€ƒæ…®ï¼‰

## è£œè¶³æƒ…å ±

- å®Ÿè¡Œãƒ­ã‚°ã¯å„Phaseã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ­ã‚°ã«è¨˜éŒ²ã•ã‚Œã¾ã™: `results/baseline/timing/phase_timings.jsonl`
- Phase5ã®å®Ÿè¡ŒçŠ¶æ³ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ­ã‚°ã§ç¢ºèªå¯èƒ½
- å„Phaseã®å®Œäº†æ™‚ã«è‡ªå‹•çš„ã«ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ­ã‚°ãŒè¨˜éŒ²ã•ã‚Œã¾ã™

